<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>KIE Workench</title>

    <link href="bower_components/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet" media="screen, print">

    <!-- PatternFly Styles -->
    <link href="bower_components/patternfly/dist/css/patternfly.min.css" rel="stylesheet" media="screen, print">
    <link href="bower_components/patternfly/dist/css/patternfly-additions.min.css" rel="stylesheet" media="screen, print">

    <!-- Custom CSS -->
    <link href="kie.css" rel="stylesheet" media="screen, print">

    <!-- jQuery -->
    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <!-- Bootstrap -->
    <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="bower_components/bootstrap-select/dist/js/bootstrap-select.min.js"></script>
    <script src="bower_components/moment/min/moment.min.js"></script>
    <script src="bower_components/bootstrap-daterangepicker/daterangepicker.js"></script>
    <!-- PatternFly -->
    <script src="bower_components/patternfly/dist/js/patternfly.min.js"></script>

</head>
<body>

<nav class="navbar navbar-default navbar-pf" role="navigation">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">
            <img src="logo.png" alt="PatternFly Enterprise Application"/>
        </a>
    </div>
    <div class="collapse navbar-collapse navbar-collapse-1">
        <ul class="nav navbar-nav navbar-utility">
            <li class="dropdown-toggle">
                <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-question"></i>
                </a>
                <ul class="dropdown-menu" role="menu">
                    <li class="dropdown-header">-- None --</li>
                </ul>
            </li>
            <li><a href="javascript:;"><i class="fa fa-cog"></i> </a></li>
            <li title="Apps launcher" class="dropdown" style="display: none;" aria-hidden="true">
                <a href="javascript:;" data-toggle="dropdown"><i class="fa fa-th"></i> </a>
                <div class="dropdown-menu infotip bottom-right kie-launcher" data-i18n-prefix="AppLauncherView.">
                    <div class="arrow"></div>
                    <div class="container-fluid">
                        <div class="row">
                            <div data-field="left-column" class="col-sm-6"></div>
                            <div data-field="right-column" class="col-sm-6"></div>
                        </div>
                    </div>
                </div>
            </li>
            <li title="About"><a href="javascript:;"><i class="fa fa-info-circle"></i> </a></li>
            <li title="Reset all Perspective layouts"><a href="javascript:;"><i class="fa fa-medkit"></i> </a></li>
            <li class="dropdown">
                <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown"><span class="pficon pficon-user"></span>admin<span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="javascript:;">Switch to Compact View</a></li>
                    <li><a href="javascript:;">Role: analyst</a></li>
                    <li><a href="javascript:;">Role: admin</a></li>
                    <li><a href="javascript:;">Log Out</a></li>
                </ul>
            </li>
        </ul>
        <ul class="nav navbar-nav navbar-primary">
            <li class="dropdown">
                <a class="dropdown-toggle" href="javascript:;" data-toggle="dropdown"> Home<span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li class=""><a href="javascript:;">Home Page</a></li>
                    <li><a href="javascript:;">Admin</a></li>
                    <li><a href="javascript:;">Timeline</a></li>
                    <li><a href="javascript:;">People</a></li>
                </ul>
            </li>
            <li class="dropdown">
                <a class="dropdown-toggle" href="javascript:;" data-toggle="dropdown"> Authoring<span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="javascript:;">Project Authoring</a></li>
                    <li><a href="javascript:;">Contributors</a></li>
                    <li><a href="javascript:;">Artifact Repository</a></li>
                    <li><a href="javascript:;">Administration</a></li>
                    <li><a href="javascript:;">Library</a></li>
                </ul>
            </li>
            <li class="dropdown">
                <a class="dropdown-toggle" href="javascript:;" data-toggle="dropdown"> Deploy<span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="javascript:;">Execution Servers</a></li>
                    <li><a href="javascript:;">Jobs</a></li>
                </ul>
            </li>
            <li class="dropdown active">
                <a class="dropdown-toggle" href="javascript:;" data-toggle="dropdown" aria-expanded="false"> Process Management<span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="javascript:;">Process Definitions</a></li>
                    <li class="active"><a href="javascript:;">Process Instances</a></li>
                </ul>
            </li>
            <li><a href="javascript:;">Tasks</a></li>
            <li class="dropdown">
                <a class="dropdown-toggle" href="javascript:;" data-toggle="dropdown"> Dashboards<span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="javascript:;">Process &amp; Task Dashboard</a></li>
                    <li><a href="javascript:;">Business Dashboards</a></li>
                </ul>
            </li>
            <li class="dropdown">
                <a class="dropdown-toggle" href="javascript:;" data-toggle="dropdown"> Extensions<span class="caret"></span></a>
                <ul class="dropdown-menu" role="menu">
                    <li><a href="javascript:;">Plugin Management</a></li>
                    <li><a href="javascript:;">Apps</a></li>
                    <li><a href="javascript:;">Data Sets</a></li>
                    <li><a href="javascript:;">Data Sources</a></li>
                </ul>
            </li>
        </ul>

    </div>
</nav>
<div class="container-fluid">
    <div class="row">
        <div class="col-md-12 kie-container">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <div class="uf-listbar-panel-header-toolbar">
                        <div class="btn-toolbar">
                            <div class="btn-group">
                                <button type="button" class="btn btn-default btn-sm">New Process Instance</button>
                                <div class="btn-group" style="display: none;" aria-hidden="true">
                                    <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown">Server Templates
                                        <span class="caret"></span></button>
                                    <ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
                                </div>
                                <button type="button" class="btn btn-default btn-sm" title="Refresh">
                                    <i class="fa fa-refresh"></i></button>
                                <div class="btn-group">
                                    <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown" title="Auto Refresh">
                                        <i class="fa fa-cog"></i> <span class="caret"></span></button>
                                    <ul class="dropdown-menu pull-right" role="menu">
                                        <li><a href="javascript:;">1 Minute</a></li>
                                        <li><a href="javascript:;">5 Minutes</a></li>
                                        <li><a href="javascript:;">10 Minutes</a></li>
                                        <li class="divider"></li>
                                        <li class="disabled" disabled="">
                                            <a href="javascript:;" class="disabled" disabled="">Auto refresh Disabled</a>
                                        </li>
                                    </ul>
                                </div>
                                <button type="button" class="btn btn-default btn-sm" title="Restore default filters">
                                    <i class="fa fa-filter"></i></button>
                            </div>
                            <div class="btn-group">
                                <button type="button" class="btn btn-default btn-sm" title="Maximize panel to fit full screen">
                                    <i class="fa fa-expand"></i></button>
                                <button type="button" class="btn btn-default btn-sm"><i class="fa fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <h3 class="panel-title">Process Instances</h3>
                </div>
                <div class="panel-body">
                    <ul class="nav nav-tabs">
                        <li class="active"><a href="#">Search</a></li>
                        <li id="activeTab"><a href="#">Active
                            <button type="button" class="btn btn-link btn-xs" style="vertical-align: text-top;" onclick="removeTab('activeTab');">
                                <i class="fa fa-times"></i></button>
                        </a></li>
                        <li id="completedTab"><a href="#">Completed
                            <button type="button" class="btn btn-link btn-xs" style="vertical-align: text-top;" onclick="removeTab('completedTab');">
                                <i class="fa fa-times"></i></button>
                        </a></li>
                        <li id="abortedTab"><a href="#">Aborted
                            <button type="button" class="btn btn-link btn-xs" style="vertical-align: text-top;" onclick="removeTab('abortedTab');">
                                <i class="fa fa-times"></i></button>
                        </a></li>
                    </ul>
                    <div class="row toolbar-pf table-view-pf-toolbar" id="toolbar1" style="border-bottom: 1px solid #d1d1d1;">
                        <div class="col-sm-12">
                            <form class="toolbar-pf-actions">
                                <div class="form-group toolbar-pf-filter">
                                    <div class="input-group">
                                        <div class="input-group-btn">
                                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                <span id="filter">Id</span>
                                                <span class="caret"></span>
                                            </button>
                                            <ul id="filters" class="dropdown-menu">
                                                <li class="hidden"><a href="#" onclick="selectFilter(this);">Id</a></li>
                                                <li><a href="#" onclick="selectFilter(this);">Correlation Key</a></li>
                                                <li><a href="#" onclick="selectFilter(this);">Initiator</a></li>
                                                <li><a href="#" onclick="selectFilter(this);">Description</a></li>
                                            </ul>
                                        </div>
                                        <input type="number" class="form-control filter-control" placeholder="Filter By Process Id..." autocomplete="off" id="Id">
                                        <input type="text" class="form-control filter-control hidden" placeholder="Filter By Correlation Key..." autocomplete="off" id="Correlation Key" onchange="addFilter('Correlation Key', this.value); this.value = '';">
                                        <input type="text" class="form-control filter-control hidden" placeholder="Filter By Description..." autocomplete="off" id="Description" onchange="addFilter('Description', this.value); this.value = '';">
                                        <input type="text" class="form-control filter-control hidden" placeholder="Filter By Initiator..." autocomplete="off" id="Initiator" onchange="addFilter('Initiator', this.value); this.value = '';">
                                        <span class="input-group-addon hidden" id="filter-help">
                                            <a  role="button" data-toggle="popover" data-field="help" data-trigger="hover click" data-html="true" title="" data-content="<p>Allowed wildcards are:</p>
                                             <ul>
                                                  <li><code>_</code> - A substitute for a single character.</li>
                                                  <li><code>%</code> - A substitute for zero or more characters.</li>
                                                  <li><code>[charlist]</code> - Sets and ranges of characters to match.</li>
                                                  <li><code>[^charlist]</code> - Matches only a character NOT specified within the brackets.</li>
                                             </ul>" data-placement="bottom" data-container="body">
                                                                                <!--<span class="pficon pficon-info"></span>-->
                                                <i class="fa fa-info-circle"></i>
                                                                            </a>
                                        </span>
                                    </div>

                                </div>
                                <div class="form-group">
                                    <select class="selectpicker form-control" data-width="auto" title="State" id="State">
                                        <option>Active</option>
                                        <option>Aborted</option>
                                        <option>Completed</option>
                                    </select>
                                    <select class="selectpicker form-control" data-width="auto" data-live-search="true" title="Name" id="Name">
                                        <option>Evaluation</option>
                                        <option>HR Process</option>
                                        <option>Review application</option>
                                        <option>Hardware Request</option>
                                    </select>
                                </div>
                                <div class="form-group" style="width: 25%;">
                                    <div class="input-group">
                                        <div class="input-group-btn">
                                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                <span>Start Date</span>
                                                <span class="caret"></span>
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li class="hidden"><a href="#">Start Date</a></li>
                                                <li><a href="#">Last Update</a></li>
                                            </ul>
                                        </div>
                                        <!--<div class="filter-control" id="Start Date">-->
                                            <input type='text' class="form-control" placeholder="Start date range..." id='datetimepicker'/>
                                        <!--</div>-->
                                    </div>
                                </div>
                            </form>
                            <div class="row toolbar-pf-results">
                                <div class="col-sm-12">
                                    <div class="">
                                        <p style="padding-right: 5px;">Active filters: </p>
                                        <ul class="list-inline taglist taglist--overflowing taglist--collapsed" id="activeFilters">
                                          <!-- this is shown when the list overflows -->
                                          <span class="taglist__viewmore"></span>

                                        </ul>
                                        <p><a href="#" onclick="removeAllFilters();">Clear All Filters</a></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row" style="margin-top: 10px; margin-bottom: 10px;">
                        <div class="col-md-4">
                            <h4>Search Results</h4>
                        </div>
                        <div class="col-md-8">
                            <div class="pull-right" style="margin-top: 5px;">
                                <div class="btn-group">
                                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" style="margin-right: 5px;">Bulk Actions
                                        <span class="caret"></span></button>
                                    <ul class="dropdown-menu dropdown-menu-right" role="menu" style="margin-right: 5px;">
                                        <li class="disabled" disabled="">
                                            <a href="javascript:;" class="disabled" disabled=""><i class="fa fa-ban fa-fw"></i> Bulk Abort</a>
                                        </li>
                                        <li class="disabled" disabled="">
                                            <a href="javascript:;" class="disabled" disabled=""><i class="fa fa-bell fa-fw"></i> Bulk Signal</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="dropdown btn-group">
                                    <button class="btn btn-default dropdown-toggle" data-toggle="dropdown" type="button">
                                        <i class="fa fa-columns"></i></button>
                                    <ul class="dropdown-menu dropdown-menu-right table-view-pf-colvis-menu" style="margin-left: 5px;">
                                        <li><input type="checkbox" checked><label>Id</label></li>
                                        <li><input type="checkbox" checked><label>Name</label></li>
                                        <li><input type="checkbox" checked><label>Description</label></li>
                                        <li><input type="checkbox" checked><label>Version</label></li>
                                        <li><input type="checkbox" checked><label>Errors</label></li>
                                        <li><input type="checkbox" checked><label>Start date</label></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <table class="table table-striped table-bordered">
                        <thead>
                        <tr>
                            <th width="10px"><input type="checkbox"/></th>
                            <th>Id</th>
                            <th>Name</th>
                            <th>Description</th>
                            <th>Version</th>
                            <th>Errors</th>
                            <th>Last Update</th>
                            <th width="250px">Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td><input type="checkbox"/></td>
                            <td>1</td>
                            <td>Evaluation</td>
                            <td>Evaluation</td>
                            <td>1</td>
                            <td><span class="label label-default">0</span></td>
                            <td>22/04/2017 09:49</td>
                            <td>
                                <button class="btn btn-default btn-xs" type="button">Signal</button>
                                <button class="btn btn-default btn-xs" type="button">Abort</button>
                                <button class="btn btn-default btn-xs" type="button">View Jobs</button>
                            </td>
                        </tr>
                        <tr>
                            <td><input type="checkbox"/></td>
                            <td>2</td>
                            <td>Evaluation</td>
                            <td>Evaluation</td>
                            <td>1</td>
                            <td><span class="label label-danger">2</span></td>
                            <td>22/04/2017 09:49</td>
                            <td>
                                <button class="btn btn-default btn-xs" type="button">Signal</button>
                                <button class="btn btn-default btn-xs" type="button">Abort</button>
                                <button class="btn btn-default btn-xs" type="button">View Jobs</button>
                                <button class="btn btn-default btn-xs" type="button">View Errors</button>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <table style="width: 100%;" cellspacing="0" cellpadding="0">
                        <tbody>
                        <tr>
                            <td style="vertical-align: middle;" align="left" width="50%">
                                <select class="form-control" style="width: 100px;">
                                    <option value="5">5 Items</option>
                                    <option value="10">10 Items</option>
                                    <option value="15">15 Items</option>
                                    <option value="20">20 Items</option>
                                </select></td>
                            <td style="vertical-align: top;" align="right" width="50%">
                                <table class="pagination pagination-right pull-right GOVM-MUGNB" cellspacing="0" cellpadding="0">
                                    <tbody>
                                    <tr>
                                        <td style="vertical-align: middle;" class="GOVM-MUH5" align="left">
                                            <button type="button" class="btn btn-default disabled" disabled="">
                                                <i class="fa fa-angle-double-left"></i></button>
                                        </td>
                                        <td style="vertical-align: middle;" class="GOVM-MUH5" align="left">
                                            <button type="button" class="btn btn-default disabled" disabled="">
                                                <i class="fa fa-angle-left"></i></button>
                                        </td>
                                        <td style="vertical-align: middle;" class="GOVM-MUI5" align="left">
                                            <div class="gwt-HTML">0 of 0</div>
                                        </td>
                                        <td style="vertical-align: middle;" class="GOVM-MUH5" align="left">
                                            <button type="button" class="btn btn-default disabled" disabled="">
                                                <i class="fa fa-angle-right"></i></button>
                                        </td>
                                        <td style="vertical-align: middle;" class="GOVM-MUH5" align="left">
                                            <button type="button" class="btn btn-default disabled" disabled="" style="">
                                                <i class="fa fa-fast-forward"></i></button>
                                        </td>
                                        <td style="vertical-align: middle;" class="GOVM-MUH5" align="left">
                                            <button type="button" class="btn btn-default disabled" disabled="" style="">
                                                <i class="fa fa-angle-double-right"></i></button>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    function removeFilter(element) {
        $(element).popover('destroy');
        $(element).remove();
    }

    function selectFilter(element) {
        $('#filter').text(element.text);
        $('#filters li').each(function (index) {
            var liElement = $(this);
            if (liElement.text() == element.text) {
                liElement.addClass("hidden");
            } else {
                liElement.removeClass("hidden");
            }
        });
        $('.filter-control').each(function (index) {
            var input = $(this);
            var selects = ['Name', 'State'];
            if (input.attr('id') == element.text) {
                if ($.inArray(input.attr('id'), selects) != -1) {
                    input.parent().removeClass("hidden");
                } else {
                    input.removeClass("hidden");
                }
                input.focus();
                if(input.attr('type') == 'number'){
                    $('#filter-help').addClass("hidden");
                } else {
                    $('#filter-help').removeClass("hidden");
                }
            } else {
                if ($.inArray(input.attr('id'), selects) != -1) {
                    input.parent().addClass("hidden");
                } else {
                    input.addClass("hidden");
                }
            }

        });
    }

    function addFilter(name, value, tooltip) {
        var li = document.createElement("li");
        var spanLabel = document.createElement("span");
        spanLabel.classList.add('label');
        spanLabel.classList.add('label-info');
        var a = document.createElement("a");
        a.href = '#';
        a.onclick = function () {
            removeFilter(li);
        };
        var spanClose = document.createElement("span");
        spanClose.classList.add('pficon');
        spanClose.classList.add('pficon-close');

        spanLabel.appendChild(document.createTextNode(name + ': ' + value));
        spanLabel.appendChild(a);
        a.appendChild(spanClose);
        li.appendChild(spanLabel);
        $('#activeFilters').append(li);
        if(name == 'Start date range'){
            li.setAttribute('data-toggle', 'popover');
            $(li).popover({
                placement: 'top',
                trigger: 'click hover',
                html: true,
                content: tooltip
            });
        }
    }

    function removeAllFilters() {
        $('#activeFilters li').remove();
    }

    $('.selectpicker').selectpicker();

    var dateFormat = 'lll';

    var start = moment().hours(0).minutes(0).seconds(0).subtract(6, 'days');
    var end = moment();

//    function cb(start, end) {
//        $('#reportrange span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
//    }

    $('#datetimepicker').daterangepicker({
        autoUpdateInput: false,
        startDate: start,
        endDate: end,
        timePicker: true,
        timePickerIncrement: 30,
        locale: {
            format: 'lll',
            customRangeLabel: 'Custom Date Range'
        },
        ranges: {
            'Today': [moment().hours(0).minutes(0).seconds(0), moment()],
            'Yesterday': [moment().hours(0).minutes(0).seconds(0).subtract(1, 'days'), moment().subtract(1, 'days').hours(24).minutes(0).seconds(0)],
            'Last 7 Days': [start, end],
            'Last 30 Days': [moment().hours(0).minutes(0).seconds(0).subtract(30, 'days'), moment()],
            'This Month': [moment().hours(0).minutes(0).seconds(0).startOf('month'), moment()],
            'Last Month': [moment().hours(0).minutes(0).seconds(0).subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
        }
    }, function(start, end, label) {
        console.log('New date range selected: ' + start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD') + ' (predefined range: ' + label + ')');
        console.log('test label: ' + end.from(start, true));
        var tooltipText = 'From: ' + start.format(dateFormat) + ' <br>To: ' + end.format(dateFormat);
        addFilter('Start date range', end.from(start, true), tooltipText);
    });

    function addInputText(input) {
        var keycode = (event.keyCode ? event.keyCode : event.which);
        if (keycode == '13') {
            addFilter(input.attr('id'), input.val());
            input.val('');
            input.focus();
        }
    }

    function addSelectText(input) {
        addFilter(input.attr('id'), input.val());
        input.val('');
    }

    $("[id='Id']").keypress(function (event) {
        addInputText($(this));
    });

    $("[id='Correlation Key']").keypress(function (event) {
        addInputText($(this));
    });

    $("[id='Initiator']").keypress(function (event) {
        addInputText($(this));
    });

    $("[id='Name']").on('changed.bs.select', function (event) {
        addSelectText($(this));
    });

    $("[id='State']").on('changed.bs.select', function (event) {
        addSelectText($(this));
    });

    function removeTab(id) {
        $('#' + id).remove();
    }

    // Initialize Popovers
    $(document).ready(function() {
        $('[data-toggle=popover]').popovers()
    });

</script>
</body>
</html>
